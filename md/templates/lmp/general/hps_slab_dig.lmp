units       real
dimension   3
boundary    p p p
atom_style  full

bond_style  harmonic
pair_style  $pair_potential $pair_parameters
dielectric  $water_perm

read_data   data.data

bond_coeff          1     9.600     3.8

$pair_coeff

special_bonds fene
neighbor  3.5 multi
neigh_modify  every 10 delay 0

comm_style    tiled
timestep      $dt

velocity      all create $temp $v_seed
fix           fxnve  all nve
fix           fxlange all langevin $temp $temp $langevin_damp $langevin_seed
fix           fxlange all langevin $temp $temp $langevin_damp $langevin_seed

compute rg all gyration

thermo        $save
thermo_style  custom step pe ke temp c_rg spcpu
thermo_modify flush yes

dump          atom_file all atom $save $lammps_dump
dump_modify   atom_file flush yes scale no

dump          dcd_file all dcd $save $dcd_dump
dump_modify   dcd_file flush yes unwrap yes


unfix fxlange
fix           fxheat all langevin $temp 600 10000 451618
run 20000

unfix fxheat
fix           fxlangcont all langevin 600 600 10000 451618
fix           fxcontract all deform 1 x final -$final_slab_x $final_slab_x y final -$final_slab_y $final_slab_y z final -$final_slab_x $final_slab_x
run 100000

unfix fxcontract
unfix fxlangcont
fix           fxlang all langevin 600 $temp 10000 451618
fix           fxslab all deform 1 z final -$final_slab_z $final_slab_z remap none
run $slab_t

unfix fxslab
unfix fxlang

fix          finalfxlang all langevin $temp $temp 10000 451618
run $t
